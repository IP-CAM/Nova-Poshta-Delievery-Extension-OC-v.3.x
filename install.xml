<?xml version="1.0" encoding="utf-8"?>
<modification>
    <code>OCNPNOVAPOSHTA1.0</code>
    <name>Parameters form for OCNP Nova Poshta</name>
    <version>1.0</version>
    <author>gadzhilov.sergey@gmail.com</author>
    <file path="catalog/view/theme/*/template/checkout/shipping_method.twig">
        <operation>
            <search><![CDATA[
            {{ quote.title }} - {{ quote.text }}</label>
            ]]></search>
            <add position="after"><![CDATA[
            {% if quote.form is defined %}{{quote.form.show()}}{% endif %}
            ]]></add>
        </operation>
    </file>
    <file path="catalog/view/theme/*/template/checkout/checkout.twig">
        <operation>
            <search><![CDATA[
            data: $('#collapse-shipping-method input[type=\'radio\']:checked, #collapse-shipping-method textarea'),
            ]]></search>
            <add position="replace"><![CDATA[
            data: $('#collapse-shipping-method input[type=\'radio\']:checked, #collapse-shipping-method textarea, #collapse-shipping-method select'),
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/checkout/shipping_method.php">
        <operation>
            <search><![CDATA[
            public function save() {
            ]]></search>
            <add position="before"><![CDATA[
            public function OCNP_updateShippingAddress()
            {
               if ($this->request->post['shipping_method'] == 'ocnp_novaposhta.warehouse')
               {
                  if (isset($this->request->post['ocnp_novaposhta_area']))
                  {
                     $this->session->data['shipping_address']['zone'] = $this->request->post['ocnp_novaposhta_area'];
                  }
               }
            }
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $this->session->data['shipping_method'] = $this->session->data['shipping_methods'][$shipping[0]]['quote'][$shipping[1]];
            ]]></search>
            <add position="after"><![CDATA[
            $this->OCNP_updateShippingAddress();
            ]]></add>
        </operation>
    </file>
</modification>